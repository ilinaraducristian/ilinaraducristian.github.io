(this.webpackJsonprendezvous=this.webpackJsonprendezvous||[]).push([[0],{113:function(e,n,t){},191:function(e,n,t){"use strict";t.r(n);var r,a=t(1),c=t.n(a),i=t(48),o=t.n(i),s=(t(113),function(e){e&&t.e(3).then(t.bind(null,199)).then((function(n){var t=n.getCLS,r=n.getFID,a=n.getFCP,c=n.getLCP,i=n.getTTFB;t(e),r(e),a(e),c(e),i(e)}))}),u=t(6),d=t.n(u),l=t(14),f=t(7),v=t(49),b=t(2),h=t(26),j=Object(b.createSlice)({name:"keycloak",initialState:{isAuthenticated:!1,subject:""},reducers:{authenticate:function(e,n){e.isAuthenticated=!0,e.subject=n.payload},deauthenticate:function(e){e.isAuthenticated=!1,e.subject=""}}}),p=j.actions,m=(p.authenticate,p.deauthenticate,j.reducer),O=Object(b.createSlice)({name:"socketio",initialState:{connected:!1},reducers:{connect:function(e){e.connected=!0},disconnect:function(e){e.connected=!1}}}),x=O.actions,g=x.connect,y=(x.disconnect,function(e){return e.socketio.connected}),C=O.reducer,I=Object(b.createSlice)({name:"mediasoup",initialState:{isLoaded:!1},reducers:{load:function(e){e.isLoaded=!0}}}),k=(I.actions.load,I.reducer),w=t(36);!function(e){e.Text="text",e.Voice="voice"}(r||(r={}));var _={editMessage:function(e,n){var t,a=n.payload,c=e.servers.find((function(e){return e.id===a.serverId}));if(void 0!==c){var i=null===(t=c.channels.concat(c.groups.map((function(e){return e.channels})).flat()).filter((function(e){return e.type===r.Text})).find((function(e){return e.id===a.channelId})))||void 0===t?void 0:t.messages.find((function(e){return e.id===a.messageId}));void 0!==i&&(i.text=a.text)}},deleteMessage:function(e,n){var t=n.payload,a=e.servers.find((function(e){return e.id===t.serverId}));if(void 0!==a){var c=a.channels.concat(a.groups.map((function(e){return e.channels})).flat()).filter((function(e){return e.type===r.Text})).find((function(e){return e.id===t.channelId}));if(void 0!==c){var i=c.messages.findIndex((function(e){return e.id===t.messageId}));-1!==i&&(c.messages.filter((function(e){return e.replyId===t.messageId})).forEach((function(e){return e.replyId=null})),c.messages.splice(i,1))}}},joinVoiceChannel:function(e,n){var t=n.payload;e.joinedVoiceChannel=t},leaveVoiceChannel:function(e){e.joinedVoiceChannel=null},addChannelUsers:function(e,n){var t=n.payload,a=e.servers.map((function(e){return e.channels.concat(e.groups.map((function(e){return e.channels})).flat()).filter((function(e){return e.type===r.Voice}))})).flat();0!==a.length&&t.forEach((function(e){var n=a.find((function(n){return n.id===e.channelId}));if(void 0!==n){var t=n.users.findIndex((function(n){return n.userId===e.userId}));-1===t?n.users.push(e):n.users[t]=e}}))}},S=function(e){return e.data.isBackendInitialized},H=function(e){var n=e.data;return n.servers.map((function(e){return e.channels.concat(e.groups.map((function(e){return e.channels})).flat())})).flat().find((function(e){return e.id===n.selectedChannel}))},N=function(e){var n=e.data;return n.servers.find((function(e){return e.id===n.selectedServer}))},V=function(e){return e.data.overlay},P=function(e){return e.data.users},L=function(e){var n=e.data,t=n.joinedVoiceChannel;if(null===t)return null;var a=n.servers.find((function(e){return e.id===t.serverId}));if(void 0===a)return null;if(null===t.groupId){var c=a.channels.find((function(e){return e.id===t.channelId&&e.type===r.Voice}));return void 0===c?null:c}if(void 0===a.groups.find((function(e){return e.id===t.groupId})))return null;var i=a.channels.find((function(e){return e.id===t.channelId&&e.type===r.Voice}));return void 0===i?null:i},M=function(e){return e.data.servers},R={setInvitation:function(e,n){var t=e.servers.find((function(n){return n.id===e.selectedServer}));void 0!==t&&(t.invitation=n.payload)},addServer:function(e,n){var t=n.payload,r=e.servers.findIndex((function(e){return e.id===t.id}));-1===r?e.servers.push(t):e.servers[r]=t},addMessages:function(e,n){var t=n.payload,a=e.servers.map((function(e){return e.channels.concat(e.groups.map((function(e){return e.channels})).flat()).filter((function(e){return e.type===r.Text}))})).flat();0!==a.length&&t.forEach((function(e){var n=a.find((function(n){return n.id===e.channelId}));if(void 0!==n){var t=n.messages.findIndex((function(n){return n.id===e.id}));-1===t?n.messages.push(e):n.messages[t]=e}}))},addUser:function(e,n){var t=n.payload,r=e.users.findIndex((function(e){return e.id===t.id}));-1===r?e.users.push(t):e.users[r]=t},addMember:function(e,n){var t,r=n.payload,a=null===(t=e.servers.find((function(e){return e.id===r.serverId})))||void 0===t?void 0:t.members;if(void 0!==a){var c=a.findIndex((function(e){return e.id===r.id}));-1===c?a.push(r):a[c]=r}},addChannel:function(e,n){var t=n.payload,r=e.servers.find((function(e){return e.id===t.serverId}));if(void 0!==r)if(null===t.groupId){var a=r.channels.findIndex((function(e){return e.id===t.id}));-1===a?r.channels.push(t):r.channels[a]=t}else{var c=r.groups.find((function(e){return e.id===t.groupId}));if(void 0===c)return;var i=c.channels.findIndex((function(e){return e.id===t.id}));-1===i?c.channels.push(t):c.channels[i]=t}},addGroup:function(e,n){var t=n.payload,r=e.servers.find((function(e){return e.id===t.serverId}));if(void 0!==r){var a=r.groups.findIndex((function(e){return e.id===t.id}));-1===a?r.groups.push(t):r.groups[a]=t}},setChannelsOrder:function(e,n){var t=n.payload,r=N({data:e});void 0!==r&&t.forEach((function(e){if(null===e.groupId){var n=r.channels.find((function(n){return n.id===e.id}));if(void 0===n)return;n.order=e.order}else{var t=r.groups.find((function(n){return n.id===e.groupId}));if(void 0===t)return;var a=t.channels.find((function(n){return n.id===e.id}));if(void 0===a)return;a.order=e.order}}))}},E=Object(w.a)(Object(w.a)({initializeBackend:function(e,n){var t=n.payload,r=t.servers,a=t.users;e.servers=r,e.users=a,e.isBackendInitialized=!0},setOverlay:function(e,n){var t=n.payload;e.overlay=t},closeOverlay:function(e){e.overlay=null},selectServer:function(e,n){var t=n.payload;e.selectedChannel=null,e.selectedServer=t},selectChannel:function(e,n){var t=n.payload;e.selectedChannel=t}},R),_),T=Object(b.createSlice)({name:"data",initialState:{isBackendInitialized:!1,servers:[],users:[],selectedServer:null,selectedChannel:null,joinedVoiceChannel:null,overlay:null},reducers:E}),A=T.actions,D=A.setChannelsOrder,Z=A.initializeBackend,z=A.setInvitation,q=(A.closeOverlay,A.addChannelUsers),U=A.joinVoiceChannel,B=(A.leaveVoiceChannel,A.selectServer),F=A.selectChannel,Q=A.setOverlay,G=A.addServer,J=A.addMessages,K=A.addMember,W=A.addChannel,X=A.deleteMessage,Y=A.editMessage,$=A.addGroup,ee=A.addUser,ne=T.reducer,te=t(96),re=t(50),ae=t(107),ce=t(106),ie={offline:!1,backend:"https://rendezvous-api-radu.herokuapp.com/",socketIoUrl:"https://rendezvous-api-radu.herokuapp.com/",auth0:{domain:"rendezvous-iam.eu.auth0.com",client_id:"l1ZnZCOMXFKzMO0plbn0dl4o6Ijyg0se"},keycloak:{url:"http://rendezvous.myddns.me:30000/auth",realm:"capp",clientId:"auth-code"}},oe=t(63),se=new(t(95).Device),ue=new MediaStream,de=new AudioContext,le=new Audio("/notification.ogg"),fe=!1;var ve=se;function be(e){for(var n=arguments.length,t=new Array(n>1?n-1:0),r=1;r<n;r++)t[r-1]=arguments[r];return new Promise((function(n){if(0===t.length)return he.emit(e,0,n);he.emit.apply(he,[e].concat(t,[n]))}))}oe.Socket;var he=Object(oe.io)(ie.socketIoUrl,{autoConnect:!1,transports:["websocket"]});Object.assign(he,{emitAck:be}),he.auth={},he.on("connect",Object(l.a)(d.a.mark((function e(){var n,t;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!ve.loaded){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,he.emitAck("get_router_capabilities");case 4:return n=e.sent,t=n.routerRtpCapabilities,e.next=8,ve.load({routerRtpCapabilities:t});case 8:He.dispatch(g());case 9:case"end":return e.stop()}}),e)})))),he.on("disconnect",(function(){window.location.reload()})),he.on("new_message",(function(e){He.dispatch(J([e])),document.hidden&&(le.currentTime=0,le.play())})),he.on("new_member",(function(e){He.dispatch(K(e))})),he.on("new_channel",(function(e){He.dispatch(W(e))})),he.on("new_group",(function(e){He.dispatch($(e))})),he.on("user_joined_voice-channel",(function(e){He.dispatch(q([e]))})),he.on("message_edited",(function(e){He.dispatch(Y(e))})),he.on("message_deleted",(function(e){He.dispatch(X(e))}));var je,pe,me=he,Oe=Object(te.createApi)({reducerPath:"socketioApi",baseQuery:function(e){var n=e.ev,t=e.data;return me.emitAck(n,t).then((function(e){return{data:e}}))},endpoints:function(e){return{getUserData:e.query({query:function(){return{ev:"get_user_data"}}}),joinServer:e.query({query:function(e){return{ev:"join_server",data:{invitation:e}}}}),createServer:e.query({query:function(e){return{ev:"create_server",data:{name:e}}}}),createChannel:e.query({query:function(e){return{ev:"create_channel",data:e}}}),createGroup:e.query({query:function(e){return{ev:"create_group",data:e}}}),getMessages:e.query({query:function(e){return{ev:"get_messages",data:e}}}),createInvitation:e.query({query:function(e){return{ev:"create_invitation",data:{serverId:e}}},transformResponse:function(e){return e.invitation}}),editMessage:e.query({query:function(e){return{ev:"edit_message",data:e}}}),deleteMessage:e.query({query:function(e){return{ev:"delete_message",data:e}}})}}}),xe=Oe.useLazyGetUserDataQuery,ge=Oe.useLazyJoinServerQuery,ye=Oe.useLazyCreateServerQuery,Ce=Oe.useLazyCreateChannelQuery,Ie=Oe.useLazyCreateGroupQuery,ke=Oe.useLazyGetMessagesQuery,we=Oe.useLazyCreateInvitationQuery,_e=Oe.useLazyEditMessageQuery,Se=Oe.useLazyDeleteMessageQuery,He=Object(b.configureStore)({reducer:Object(v.a)({keycloak:m,socketio:C,mediasoup:k,data:ne},Oe.reducerPath,Oe.reducer),middleware:function(e){return e().concat(Oe.middleware)}}),Ne=function(){return Object(h.useDispatch)()},Ve=h.useSelector,Pe=new(t(97).LoremIpsum)({sentencesPerParagraph:{max:8,min:4},wordsPerSentence:{max:16,min:4}}),Le=[{id:"97a8ffc2-10cd-47dd-b915-cf8243d5bfc4",username:"user1",firstName:"Firstname",lastName:"Lastname"}],Me=[{id:1,name:"Server",userId:"97a8ffc2-10cd-47dd-b915-cf8243d5bfc4",invitation:null,invitationExp:null,channels:[{id:1,serverId:1,groupId:null,type:r.Text,name:"channel 1",order:0,messages:new Array(100).fill(0).map((function(e,n){return{id:n+1,serverId:1,channelId:1,userId:"97a8ffc2-10cd-47dd-b915-cf8243d5bfc4",timestamp:(new Date).toString(),text:Pe.generateParagraphs(1),isReply:!1,replyId:null}}))},{id:2,serverId:1,groupId:null,type:r.Text,name:"channel 2",order:1,messages:new Array(100).fill(0).map((function(e,n){return{id:n+100,serverId:1,channelId:2,userId:"97a8ffc2-10cd-47dd-b915-cf8243d5bfc4",timestamp:(new Date).toString(),text:Pe.generateParagraphs(1),isReply:!1,replyId:null}}))},{id:3,serverId:1,groupId:null,type:r.Text,name:"channel 3",order:2,messages:new Array(100).fill(0).map((function(e,n){return{id:n+200,serverId:1,channelId:3,userId:"97a8ffc2-10cd-47dd-b915-cf8243d5bfc4",timestamp:(new Date).toString(),text:Pe.generateParagraphs(1),isReply:!1,replyId:null}}))}],groups:[{id:1,serverId:1,name:"Text channels",channels:[{id:4,serverId:1,groupId:1,type:r.Text,name:"channel 4",order:0,messages:new Array(100).fill(0).map((function(e,n){return{id:n+300,serverId:1,channelId:4,userId:"97a8ffc2-10cd-47dd-b915-cf8243d5bfc4",timestamp:(new Date).toString(),text:Pe.generateParagraphs(1),isReply:!1,replyId:null}}))},{id:5,serverId:1,groupId:1,type:r.Text,name:"channel 5",order:1,messages:new Array(100).fill(0).map((function(e,n){return{id:n+500,serverId:1,channelId:5,userId:"97a8ffc2-10cd-47dd-b915-cf8243d5bfc4",timestamp:(new Date).toString(),text:Pe.generateParagraphs(1),isReply:!1,replyId:null}}))},{id:6,serverId:1,groupId:1,type:r.Text,name:"channel 6",order:2,messages:new Array(100).fill(0).map((function(e,n){return{id:n+600,serverId:1,channelId:6,userId:"97a8ffc2-10cd-47dd-b915-cf8243d5bfc4",timestamp:(new Date).toString(),text:Pe.generateParagraphs(1),isReply:!1,replyId:null}}))}]},{id:2,serverId:1,name:"Voice channels",channels:[{id:7,serverId:1,groupId:2,type:r.Voice,name:"channel 7",order:0,users:[]},{id:8,serverId:1,groupId:2,type:r.Voice,name:"channel 8",order:1,users:[]},{id:9,serverId:1,groupId:2,type:r.Voice,name:"channel 9",order:2,users:[]}]}],members:[{id:1,serverId:1,userId:"97a8ffc2-10cd-47dd-b915-cf8243d5bfc4"}]}],Re=t(4),Ee=t(5),Te=t(0);var Ae,De=Ee.a.li(je||(je=Object(Re.a)(["\n  display: flex;\n  margin: 0.5em 0;\n"]))),Ze=Ee.a.button(pe||(pe=Object(Re.a)(["\n  background-color: var(--color-secondary);\n  border: thin solid var(--color-secondary);\n  color: white;\n  font-size: 1.5rem;\n  border-radius: 50%;\n  width: 2em;\n  height: 2em;\n"]))),ze=function(e){var n=e.name,t=e.onSelectServer;return Object(Te.jsx)(De,{className:"li",children:Object(Te.jsx)(Ze,{className:"btn",type:"button",onClick:t,children:n[0]})})};var qe,Ue=Ee.a.ol(Ae||(Ae=Object(Re.a)(["\n  display: flex;\n  align-items: center;\n  flex-direction: column;\n  background-color: var(--color-primary);\n  width: 4.5em;\n  overflow-y: auto;\n  flex-shrink: 0;\n"]))),Be=function(){var e=Ne(),n=Ve(M);return Object(Te.jsxs)(Ue,{className:"list list__panel",children:[n.map((function(n){return Object(Te.jsx)(ze,{name:n.name,onSelectServer:function(){return function(n){e(B(n.id))}(n)}},"server_".concat(n.id))})),Object(Te.jsx)(ze,{name:"+",onSelectServer:function(){e(Q({type:"AddServerOverlayComponent"}))}})]})},Fe=t(197),Qe="channel",Ge=Ee.a.div(qe||(qe=Object(Re.a)(["\n\n  height: 0.5em;\n  background-color: ",";\n\n"])),(function(e){return e.Hidden?"transparent":"green"}));var Je=function(e){var n=e.index,t=e.groupId,r=Ve(N),c=Object(a.useState)(!0),i=Object(f.a)(c,2),o=i[0],s=i[1],u=Ne(),d=Object(a.useCallback)((function(e){if(t===e.groupId){if(void 0===r)return;if(null===t){if(e.order===n||e.order+1===n)return;var a=r.channels.filter((function(n){return n.id!==e.id})).map((function(e){return{id:e.id,order:e.order,groupId:null}}));e.order<n?(a.forEach((function(e){e.order>=n&&e.order++})),a.forEach((function(n){n.order>e.order&&n.order--}))):(a.forEach((function(n){n.order>e.order&&n.order--})),a.forEach((function(e){e.order>=n&&e.order++}))),a.push({id:e.id,order:n,groupId:t}),u(D(a))}else{var c=r.groups.find((function(e){return e.id===t}));if(void 0===c)return;var i=c.channels.filter((function(n){return n.id!==e.id})).map((function(e){return{id:e.id,order:e.order,groupId:t}}));e.order<n?(i.forEach((function(e){e.order>=n&&e.order++})),i.forEach((function(n){n.order>e.order&&n.order--}))):(i.forEach((function(n){n.order>e.order&&n.order--})),i.forEach((function(e){e.order>=n&&e.order++}))),i.push({id:e.id,order:n,groupId:t}),u(D(i))}}}),[t,n,u,r]),l=Object(a.useCallback)((function(){s(!1)}),[s]),v=Object(a.useCallback)((function(e){return{isOver:e.isOver()}}),[]),b=Object(Fe.a)({accept:Qe,drop:d,hover:l,collect:v},[d,l,v]),h=Object(f.a)(b,2),j=h[0],p=h[1];return Object(a.useEffect)((function(){s(!j.isOver)}),[j]),Object(Te.jsx)(Ge,{Hidden:o,ref:p})},Ke=t(198);var We,Xe,Ye=function(e){var n=e.type,t=e.isPrivate;return n===r.Text?t?Object(Te.jsxs)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",children:[Object(Te.jsx)("path",{fill:"currentColor",d:"M14 8C14 7.44772 13.5523 7 13 7H9.76001L10.3657 3.58738C10.4201 3.28107 10.1845 3 9.87344 3H8.88907C8.64664 3 8.43914 3.17391 8.39677 3.41262L7.76001 7H4.18011C3.93722 7 3.72946 7.17456 3.68759 7.41381L3.51259 8.41381C3.45905 8.71977 3.69449 9 4.00511 9H7.41001L6.35001 15H2.77011C2.52722 15 2.31946 15.1746 2.27759 15.4138L2.10259 16.4138C2.04905 16.7198 2.28449 17 2.59511 17H6.00001L5.39427 20.4126C5.3399 20.7189 5.57547 21 5.88657 21H6.87094C7.11337 21 7.32088 20.8261 7.36325 20.5874L8.00001 17H14L13.3943 20.4126C13.3399 20.7189 13.5755 21 13.8866 21H14.8709C15.1134 21 15.3209 20.8261 15.3632 20.5874L16 17H19.5799C19.8228 17 20.0306 16.8254 20.0724 16.5862L20.2474 15.5862C20.301 15.2802 20.0655 15 19.7549 15H16.35L16.6758 13.1558C16.7823 12.5529 16.3186 12 15.7063 12C15.2286 12 14.8199 12.3429 14.7368 12.8133L14.3504 15H8.35045L9.41045 9H13C13.5523 9 14 8.55228 14 8Z"}),Object(Te.jsx)("path",{fill:"currentColor",d:"M21.025 5V4C21.025 2.88 20.05 2 19 2C17.95 2 17 2.88 17 4V5C16.4477 5 16 5.44772 16 6V9C16 9.55228 16.4477 10 17 10H19H21C21.5523 10 22 9.55228 22 9V5.975C22 5.43652 21.5635 5 21.025 5ZM20 5H18V4C18 3.42857 18.4667 3 19 3C19.5333 3 20 3.42857 20 4V5Z"})]}):Object(Te.jsx)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",children:Object(Te.jsx)("path",{fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd",d:"M5.88657 21C5.57547 21 5.3399 20.7189 5.39427 20.4126L6.00001 17H2.59511C2.28449 17 2.04905 16.7198 2.10259 16.4138L2.27759 15.4138C2.31946 15.1746 2.52722 15 2.77011 15H6.35001L7.41001 9H4.00511C3.69449 9 3.45905 8.71977 3.51259 8.41381L3.68759 7.41381C3.72946 7.17456 3.93722 7 4.18011 7H7.76001L8.39677 3.41262C8.43914 3.17391 8.64664 3 8.88907 3H9.87344C10.1845 3 10.4201 3.28107 10.3657 3.58738L9.76001 7H15.76L16.3968 3.41262C16.4391 3.17391 16.6466 3 16.8891 3H17.8734C18.1845 3 18.4201 3.28107 18.3657 3.58738L17.76 7H21.1649C21.4755 7 21.711 7.28023 21.6574 7.58619L21.4824 8.58619C21.4406 8.82544 21.2328 9 20.9899 9H17.41L16.35 15H19.7549C20.0655 15 20.301 15.2802 20.2474 15.5862L20.0724 16.5862C20.0306 16.8254 19.8228 17 19.5799 17H16L15.3632 20.5874C15.3209 20.8261 15.1134 21 14.8709 21H13.8866C13.5755 21 13.3399 20.7189 13.3943 20.4126L14 17H8.00001L7.36325 20.5874C7.32088 20.8261 7.11337 21 6.87094 21H5.88657ZM9.41045 9L8.35045 15H14.3504L15.4104 9H9.41045Z"})}):t?Object(Te.jsxs)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",children:[Object(Te.jsx)("path",{fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd",d:"M15 12C15 12.0007 15 12.0013 15 12.002C15 12.553 14.551 13.002 14 13.002V15.002C15.654 15.002 17 13.657 17 12.002C17 12.0013 17 12.0007 17 12H15ZM19 12C19 12.0007 19 12.0013 19 12.002C19 14.759 16.757 17.002 14 17.002V19.002C17.86 19.002 21 15.863 21 12.002C21 12.0013 21 12.0007 21 12H19ZM10.293 3.29604C10.579 3.01004 11.009 2.92504 11.383 3.07904C11.757 3.23204 12 3.59904 12 4.00204V20.002C12 20.407 11.757 20.772 11.383 20.927C11.009 21.082 10.579 20.996 10.293 20.71L6 16.002H3C2.45 16.002 2 15.552 2 15.002V9.00204C2 8.45304 2.45 8.00204 3 8.00204H6L10.293 3.29604Z"}),Object(Te.jsx)("path",{fill:"currentColor",d:"M21.025 5V4C21.025 2.88 20.05 2 19 2C17.95 2 17 2.88 17 4V5C16.4477 5 16 5.44772 16 6V9C16 9.55228 16.4477 10 17 10H19H21C21.5523 10 22 9.55228 22 9V5.975C22 5.43652 21.5635 5 21.025 5ZM20 5H18V4C18 3.42857 18.4667 3 19 3C19.5333 3 20 3.42857 20 4V5Z"})]}):Object(Te.jsx)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",children:Object(Te.jsx)("path",{fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd",d:"M11.383 3.07904C11.009 2.92504 10.579 3.01004 10.293 3.29604L6 8.00204H3C2.45 8.00204 2 8.45304 2 9.00204V15.002C2 15.552 2.45 16.002 3 16.002H6L10.293 20.71C10.579 20.996 11.009 21.082 11.383 20.927C11.757 20.772 12 20.407 12 20.002V4.00204C12 3.59904 11.757 3.23204 11.383 3.07904ZM14 5.00195V7.00195C16.757 7.00195 19 9.24595 19 12.002C19 14.759 16.757 17.002 14 17.002V19.002C17.86 19.002 21 15.863 21 12.002C21 8.14295 17.86 5.00195 14 5.00195ZM14 9.00195C15.654 9.00195 17 10.349 17 12.002C17 13.657 15.654 15.002 14 15.002V13.002C14.551 13.002 15 12.553 15 12.002C15 11.451 14.551 11.002 14 11.002V9.00195Z"})})},$e=Ee.a.button(We||(We=Object(Re.a)(["\n  display: flex;\n"])));var en=Ee.a.ul(Xe||(Xe=Object(Re.a)(["\n  color: white;\n"]))),nn=function(e){var n=e.channel,t=Ve(P),r=Ne(),c=Object(a.useRef)(!1),i=Object(a.useCallback)(Object(l.a)(d.a.mark((function e(){var n,t,r,a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,navigator.mediaDevices.getUserMedia({audio:!0});case 2:return n=e.sent,e.next=5,me.emitAck("create_transport",{type:"send"});case 5:return t=e.sent,r=t.transportParameters,(a=ve.createSendTransport(r)).on("connect",(function(e,n){var t=e.dtlsParameters;me.emit("connect_transport",{type:"send",dtlsParameters:t,id:a.id},n)})),a.on("produce",function(){var e=Object(l.a)(d.a.mark((function e(n,t){var r,c;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,me.emitAck("create_producer",{id:a.id,kind:n.kind,rtpParameters:n.rtpParameters,appData:n.appData});case 2:r=e.sent,c=r.producerId,t({id:c});case 5:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}()),e.next=12,a.produce({track:null===n||void 0===n?void 0:n.getAudioTracks()[0]});case 12:case"end":return e.stop()}}),e)}))),[]),o=Object(a.useCallback)((function(){ie.offline||c.current||(c.current=!0,r(U(n.id)))}),[c.current,n,i]),s=Object(Ke.a)({type:Qe,item:{id:n.id,order:n.order,groupId:n.groupId}},[n.order]),u=Object(f.a)(s,2)[1];return Object(Te.jsxs)("li",{ref:u,children:[Object(Te.jsxs)($e,{className:"btn",type:"button",onClick:o,children:[Object(Te.jsx)(Ye,{type:n.type,isPrivate:!1}),Object(Te.jsx)("span",{className:"span",children:n.name})]}),Object(Te.jsx)(en,{className:"list",children:n.users.map((function(e){return t.find((function(n){return n.id===e.userId}))})).filter((function(e){return void 0!==e})).map((function(e,t){return Object(Te.jsx)("li",{className:"li",children:null===e||void 0===e?void 0:e.username},"channel_".concat(n.id,"_user").concat(t))}))})]})};var tn=function(e){var n=e.channel,t=ke(),r=Object(f.a)(t,2),c=r[0],i=r[1],o=i.data,s=i.isSuccess,u=Ne();Object(a.useEffect)((function(){s&&void 0!==o&&(u(J(o)),u(F(n.id)))}),[s]);var d=Object(a.useCallback)((function(){ie.offline?u(F(n.id)):c({serverId:n.serverId,channelId:n.id,offset:0})}),[n.id,n.serverId]),l=Object(Ke.a)({type:Qe,item:{id:n.id,order:n.order,groupId:n.groupId}},[n.order]),v=Object(f.a)(l,2)[1];return Object(Te.jsx)("li",{ref:v,children:Object(Te.jsxs)($e,{className:"btn",type:"button",onClick:d,children:[Object(Te.jsx)(Ye,{type:n.type,isPrivate:!1}),Object(Te.jsx)("span",{className:"span",children:n.name})]})})},rn=function(e){var n=e.data;if(null===n.selectedChannel)return[];var t=N({data:n});if(void 0===t)return[];var a=t.channels.concat(t.groups.map((function(e){return e.channels})).flat()).find((function(e){return e.id===n.selectedChannel&&e.type===r.Text}));return void 0===a?[]:a.messages},an=function(e){var n=e.data,t=L({data:n});return null===t?[]:t.users};function cn(e){return function(n,t){return[n.type===r.Text?Object(Te.jsx)(tn,{channel:n},"channel_".concat(n.id)):Object(Te.jsx)(nn,{channel:n},"channel_".concat(n.id)),Object(Te.jsx)(Je,{index:t+1,groupId:e},"drop-handle_".concat(t+1))]}}var on,sn,un,dn,ln=function(e){var n=e.groupId,t=void 0===n?null:n,r=Ve(function(e){return function(n){var t=n.data;if(null===t.selectedServer)return[];var r=t.servers.find((function(e){return e.id===t.selectedServer}));if(void 0===r)return[];if(null===e)return r.channels;var a=r.groups.find((function(n){return n.id===e}));return void 0===a?[]:a.channels}}(t));return Object(Te.jsxs)(Te.Fragment,{children:[Object(Te.jsx)(Je,{index:0,groupId:t},"drop-handle_0"),void 0===r||Array.from(r).sort((function(e,n){return e.order-n.order})).map(cn(t)).flat(2)]})},fn=t(196),vn=t(105);var bn,hn,jn,pn,mn=Ee.a.div(on||(on=Object(Re.a)(["\n  padding: 1em;\n"]))),On=Ee.a.ul(sn||(sn=Object(Re.a)(["\n  background-color: var(--color-10th);\n  color: var(--color-11th);\n  border-radius: 0.5em;\n  border: solid var(--color-10th);\n  border-width: 0.5em;\n"]))),xn=Ee.a.li(un||(un=Object(Re.a)(["\n  &:hover {\n    background-color: var(--color-12th);\n    color: white;\n  }\n"]))),gn=Ee.a.button(dn||(dn=Object(Re.a)(["\n  color: currentColor;\n  width: 100%;\n  text-align: start;\n"]))),yn=function(e){var n=e.setIsDropdownShown,t=Ve(N),r=we(),c=Object(f.a)(r,2),i=c[0],o=c[1].data,s=Ne(),u=Object(a.useCallback)(Object(l.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==t){e.next=2;break}return e.abrupt("return");case 2:i(t.id);case 3:case"end":return e.stop()}}),e)}))),[i,t]);Object(a.useEffect)((function(){void 0!==o&&(s(z(o)),s(Q({type:"InvitationOverlayComponent",payload:{invitation:o}})),n(!1))}),[o]);var v=Object(a.useCallback)(Object(l.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n(!1),s(Q({type:"CreateChannelOverlayComponent",payload:{groupId:null}}));case 2:case"end":return e.stop()}}),e)}))),[n,s]),b=Object(a.useCallback)(Object(l.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n(!1),s(Q({type:"CreateGroupOverlayComponent"}));case 2:case"end":return e.stop()}}),e)}))),[n,s]);return Object(Te.jsx)(mn,{children:Object(Te.jsxs)(On,{className:"list",children:[Object(Te.jsx)(xn,{children:Object(Te.jsx)(gn,{type:"button",className:"btn",onClick:u,children:"Invite people"})}),Object(Te.jsx)(xn,{children:Object(Te.jsx)(gn,{type:"button",className:"btn",onClick:v,children:"Create channel"})}),Object(Te.jsx)(xn,{children:Object(Te.jsx)(gn,{type:"button",className:"btn",onClick:b,children:"Create group"})})]})})},Cn=Ee.a.svg(bn||(bn=Object(Re.a)(["\n  transition: transform .2s ease-out, -webkit-transform .2s ease-out;\n  transform: ",";\n"])),(function(e){return e.isCollapsed?"rotate(-90deg)":"none"}));function In(e){var n=e.isCollapsed,t=void 0===n||n;return Object(Te.jsx)(Cn,{isCollapsed:t,width:"24",height:"24",viewBox:"0 0 24 24",children:Object(Te.jsx)("path",{fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd",d:"M16.59 8.59004L12 13.17L7.41 8.59004L6 10L12 16L18 10L16.59 8.59004Z"})})}function kn(e){var n=e.isCollapsed,t=void 0===n||n;return Object(Te.jsx)(Cn,{isCollapsed:t,width:"18",height:"18",children:Object(Te.jsxs)("g",{fill:"none",fillRule:"evenodd",children:[Object(Te.jsx)("path",{d:"M0 0h18v18H0"}),Object(Te.jsx)("path",{stroke:"currentColor",d:"M4.5 4.5l9 9",strokeLinecap:"round"}),Object(Te.jsx)("path",{stroke:"currentColor",d:"M13.5 4.5l-9 9",strokeLinecap:"round"})]})})}var wn=Ee.a.button(hn||(hn=Object(Re.a)(["\n  display: flex;\n  flex-grow: 1;\n  color: var(--color-9th)\n"]))),_n=Ee.a.div(jn||(jn=Object(Re.a)(["\n  display: flex;\n  /*flex-direction: column;*/\n  align-items: center;\n"]))),Sn=Ee.a.button(pn||(pn=Object(Re.a)(["\n  font-size: 1.5em;\n"]))),Hn=function(e){var n=e.id,t=e.name,r=Object(a.useState)(!0),c=Object(f.a)(r,2),i=c[0],o=c[1],s=Ne();return Object(Te.jsxs)("li",{children:[Object(Te.jsxs)(_n,{children:[Object(Te.jsxs)(wn,{className:"btn",type:"button",onClick:function(){return o(!i)},children:[Object(Te.jsx)(In,{isCollapsed:i}),Object(Te.jsx)("span",{children:t})]}),Object(Te.jsx)(Sn,{type:"button",className:"btn",onClick:function(){s(Q({type:"CreateChannelOverlayComponent",payload:{groupId:n}}))},children:"+"})]}),i||Object(Te.jsx)("ol",{className:"list",children:Object(Te.jsx)(ln,{groupId:n})})]})},Nn=function(e){var n=e.data,t=N({data:n});return void 0===t?[]:t.groups},Vn=function(e){var n=e.data,t=N({data:n});return void 0===t?[]:t.members};var Pn,Ln,Mn,Rn=function(){var e=Ve(Nn);return Object(Te.jsx)(Te.Fragment,{children:e.map((function(e){return Object(Te.jsx)(Hn,{id:e.id,name:e.name},"group_".concat(e.id))}))})};var En=Ee.a.div(Pn||(Pn=Object(Re.a)(["\n  flex-shrink: 0;\n  background-color: var(--color-third);\n  width: 15em;\n"]))),Tn=Ee.a.span(Ln||(Ln=Object(Re.a)(["\n  flex-grow: 1;\n"]))),An=Ee.a.button(Mn||(Mn=Object(Re.a)(["\n  background: none;\n  font-size: 1.5em;\n  text-align: left;\n  width: 100%;\n\n  border-style: none;\n  box-shadow: var(--small-shadow-bar);\n  display: flex;\n  align-items: center;\n  height: 2em;\n  color: var(--color-9th)\n"]))),Dn=function(){var e=Object(a.useState)(!1),n=Object(f.a)(e,2),t=n[0],r=n[1],c=Ve(N);return Object(Te.jsxs)(En,{children:[Object(Te.jsx)(An,{className:"btn",type:"button",onClick:function(){r(!t)},children:void 0===c||Object(Te.jsxs)(Te.Fragment,{children:[Object(Te.jsx)(Tn,{children:c.name}),Object(Te.jsx)(kn,{isCollapsed:!t})]})}),!t||Object(Te.jsx)(yn,{setIsDropdownShown:r}),Object(Te.jsx)(fn.a,{backend:vn.a,children:Object(Te.jsx)("ol",{className:"list",children:void 0===c||Object(Te.jsxs)(Te.Fragment,{children:[Object(Te.jsx)(ln,{}),Object(Te.jsx)(Rn,{})]})})})]})};var Zn,zn,qn,Un,Bn,Fn,Qn,Gn=function(){return Object(Te.jsxs)("svg",{x:"0",y:"0",className:"","aria-hidden":"false",width:"24",height:"24",viewBox:"0 0 24 24",children:[Object(Te.jsx)("path",{fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd",d:"M14 8.00598C14 10.211 12.206 12.006 10 12.006C7.795 12.006 6 10.211 6 8.00598C6 5.80098 7.794 4.00598 10 4.00598C12.206 4.00598 14 5.80098 14 8.00598ZM2 19.006C2 15.473 5.29 13.006 10 13.006C14.711 13.006 18 15.473 18 19.006V20.006H2V19.006Z"}),Object(Te.jsx)("path",{fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd",d:"M14 8.00598C14 10.211 12.206 12.006 10 12.006C7.795 12.006 6 10.211 6 8.00598C6 5.80098 7.794 4.00598 10 4.00598C12.206 4.00598 14 5.80098 14 8.00598ZM2 19.006C2 15.473 5.29 13.006 10 13.006C14.711 13.006 18 15.473 18 19.006V20.006H2V19.006Z"}),Object(Te.jsx)("path",{fill:"currentColor",d:"M20.0001 20.006H22.0001V19.006C22.0001 16.4433 20.2697 14.4415 17.5213 13.5352C19.0621 14.9127 20.0001 16.8059 20.0001 19.006V20.006Z"}),Object(Te.jsx)("path",{fill:"currentColor",d:"M14.8834 11.9077C16.6657 11.5044 18.0001 9.9077 18.0001 8.00598C18.0001 5.96916 16.4693 4.28218 14.4971 4.0367C15.4322 5.09511 16.0001 6.48524 16.0001 8.00598C16.0001 9.44888 15.4889 10.7742 14.6378 11.8102C14.7203 11.8418 14.8022 11.8743 14.8834 11.9077Z"})]})};var Jn=Ee.a.div(Zn||(Zn=Object(Re.a)(["\n  display: flex;\n  flex-direction: column;\n"]))),Kn=Ee.a.div(zn||(zn=Object(Re.a)(["\n  position: relative;\n"]))),Wn=Ee.a.div(qn||(qn=Object(Re.a)(["\n  position: absolute;\n  right: 1em;\n  background: blue;\n"]))),Xn=Ee.a.div(Un||(Un=Object(Re.a)(["\n  display: flex;\n"]))),Yn=Ee.a.time(Bn||(Bn=Object(Re.a)(["\n  margin: 0 1em;\n  flex-shrink: 0;\n"]))),$n=Ee.a.span(Fn||(Fn=Object(Re.a)(["\n  font-weight: 1000;\n  flex-shrink: 0;\n"]))),et=Ee.a.span(Qn||(Qn=Object(Re.a)(["\n  margin: 0 1em;\n"]))),nt=function(e){var n=e.serverId,t=e.channelId,r=e.messageId,c=e.username,i=e.timestamp,o=e.text,s=e.isReply,u=e.replyId,d=e.reply,l=new Date(i),v=Object(a.useState)(!1),b=Object(f.a)(v,2),h=b[0],j=b[1],p=Ne(),m=_e(),O=Object(f.a)(m,2),x=O[0],g=O[1],y=g.isFetching,C=g.isSuccess,I=Se(),k=Object(f.a)(I,2),w=k[0],_=k[1],S=_.isFetching,H=_.isSuccess,N=Object(a.useState)(!1),V=Object(f.a)(N,2),P=V[0],L=V[1],M=Object(a.useRef)(null),R=Object(a.useState)(""),E=Object(f.a)(R,2),T=E[0],A=E[1];return Object(a.useEffect)((function(){var e;C&&!y&&(p(Y({serverId:n,channelId:t,messageId:r,text:null===(e=M.current)||void 0===e?void 0:e.innerText})),L(!1))}),[C,y]),Object(a.useEffect)((function(){S&&!H&&p(X({serverId:n,channelId:t,messageId:r}))}),[S,H]),Object(Te.jsxs)(Kn,{onMouseEnter:function(){j(!0)},onMouseLeave:function(){j(!1)},children:[!h||Object(Te.jsxs)(Wn,{children:[Object(Te.jsx)("button",{type:"button",onClick:function(){if(P){if(null===M.current)return;M.current.innerText=T,L(!1)}else{if(null===M.current)return;A(M.current.innerText),L(!0)}},children:"E"}),Object(Te.jsx)("button",{type:"button",onClick:function(){return d(r)},children:"R"}),Object(Te.jsx)("button",{type:"button",onClick:function(){ie.offline?p(X({serverId:n,channelId:t,messageId:r})):w({serverId:n,channelId:t,messageId:r})},children:"D"})]}),!s||Object(Te.jsx)("div",{children:null===u?"message has been deleted":"replied to ".concat(u)}),Object(Te.jsxs)(Xn,{children:[Object(Te.jsxs)(Yn,{dateTime:l.toISOString(),children:[l.getHours()," : ",l.getMinutes()]}),Object(Te.jsx)($n,{children:c}),Object(Te.jsxs)(Jn,{children:[Object(Te.jsx)(et,{suppressContentEditableWarning:!0,contentEditable:P,ref:M,children:o}),!P||Object(Te.jsx)("button",{type:"button",onClick:function(){var e;ie.offline||x({serverId:n,channelId:t,messageId:r,text:(null===(e=M.current)||void 0===e?void 0:e.innerText)||""})},children:"Save"})]})]})]})};var tt,rt=function(){return Object(Te.jsx)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",children:Object(Te.jsx)("path",{fill:"currentColor",d:"M12 2.00098C6.486 2.00098 2 6.48698 2 12.001C2 17.515 6.486 22.001 12 22.001C17.514 22.001 22 17.515 22 12.001C22 6.48698 17.514 2.00098 12 2.00098ZM17 13.001H13V17.001H11V13.001H7V11.001H11V7.00098H13V11.001H17V13.001Z"})})};var at=Ee.a.span(tt||(tt=Object(Re.a)(["\n  background: none;\n  border: none;\n  flex-grow: 1;\n  word-wrap: anywhere;\n  max-height: inherit;\n  overflow-y: auto;\n  align-self: center;\n\n  &:focus {\n    outline: none;\n  }\n"]))),ct=function(e){var n=e.onKeyDown,t=e.onKeyUp,r=e.onClick,c=Object(a.useCallback)((function(e){e.preventDefault();var n=getSelection(),t=e.clipboardData;null!==n&&null!==t&&t.setData("text/plain",n.toString())}),[]);return Object(Te.jsx)(at,{role:"textbox",contentEditable:!0,onKeyDown:n,onKeyUp:t,onCopy:c,onClick:r})};var it=function(){return Object(Te.jsx)("svg",{width:"24",height:"24","aria-hidden":"false",viewBox:"0 0 24 24",className:"svg__emoji",children:Object(Te.jsx)("path",{fill:"currentColor",d:"M2 2C0.895431 2 0 2.89543 0 4V20C0 21.1046 0.89543 22 2 22H22C23.1046 22 24 21.1046 24 20V4C24 2.89543 23.1046 2 22 2H2ZM9.76445 11.448V15.48C8.90045 16.044 7.88045 16.356 6.74045 16.356C4.11245 16.356 2.66045 14.628 2.66045 12.072C2.66045 9.504 4.23245 7.764 6.78845 7.764C7.80845 7.764 8.66045 8.004 9.32045 8.376L9.04445 10.164C8.42045 9.768 7.68845 9.456 6.83645 9.456C5.40845 9.456 4.71245 10.512 4.71245 12.06C4.71245 13.62 5.43245 14.712 6.86045 14.712C7.31645 14.712 7.64045 14.616 7.97645 14.448V12.972H6.42845V11.448H9.76445ZM11.5481 7.92H13.6001V16.2H11.5481V7.92ZM20.4724 7.92V9.636H17.5564V11.328H19.8604V13.044H17.5564V16.2H15.5164V7.92H20.4724Z"})})},ot=t(102),st=new(t.n(ot).a)([],{ignoreCase:!1,splitOnRegEx:!1,expandRegexes:[],min:3}),ut=[{emoji:String.fromCodePoint(128512),shortcut:"grinning_face"},{emoji:String.fromCodePoint(128515),shortcut:"grinning_face_with_big_eyes"},{emoji:String.fromCodePoint(128516),shortcut:"grinning_face_with_smiling_eyes"},{emoji:String.fromCodePoint(128513),shortcut:"beaming_face_with_smiling_eyes"},{emoji:String.fromCodePoint(128518),shortcut:"grinning_squinting_face"},{emoji:String.fromCodePoint(128517),shortcut:"grinning_face_with_sweat"},{emoji:String.fromCodePoint(129315),shortcut:"rolling_on_the_floor_laughing"},{emoji:String.fromCodePoint(128514),shortcut:"face_with_tears_of_joy"},{emoji:String.fromCodePoint(128578),shortcut:"slightly_smiling_face"},{emoji:String.fromCodePoint(128579),shortcut:"upside-down_face"},{emoji:String.fromCodePoint(129760),shortcut:"melting_face"},{emoji:String.fromCodePoint(128521),shortcut:"winking_face"},{emoji:String.fromCodePoint(128522),shortcut:"smiling_face_with_smiling_eyes"},{emoji:String.fromCodePoint(128519),shortcut:"smiling_face_with_halo"}];ut.forEach((function(e){st.map(":".concat(e.shortcut),e.emoji)}));var dt,lt,ft,vt=st,bt=Object(a.forwardRef)((function(e,n){var t=e.foundEmojis,r=Object(a.useState)(0),c=Object(f.a)(r,2),i=c[0],o=c[1];return Object(a.useImperativeHandle)(n,(function(){return{move:function(e){e?o(i-1===-1?t.length-1:i-1):i+1===t.length?o(0):o(i+1)},getEmoji:function(){return t[i]}}})),Object(Te.jsx)(Te.Fragment,{children:t.map((function(e,n){var t;return Object(Te.jsxs)(ht,{highlighted:n===i,children:[Object(Te.jsx)("div",{children:e}),Object(Te.jsx)("div",{children:null===(t=ut.find((function(n){return n.emoji===e})))||void 0===t?void 0:t.shortcut})]},"emoji_".concat(n))}))})})),ht=Ee.a.div(dt||(dt=Object(Re.a)(["\n  display: flex;\n  align-content: space-between;\n\n  background-color: ",";\n"])),(function(e){return e.highlighted?"blue":"red"})),jt=bt;var pt,mt,Ot,xt=Ee.a.footer(lt||(lt=Object(Re.a)(["\n  background-color: var(--color-fifth);\n  border-radius: 0.5em;\n  max-height: 12.5em;\n  margin: 0 1em 1.5em 1em;\n  display: flex;\n  align-items: flex-start;\n"]))),gt=Ee.a.div(ft||(ft=Object(Re.a)(['\n  background-image: url("assets/emojis.png");\n  background-position: 0 0;\n  background-size: 242px 110px;\n  background-repeat: no-repeat;\n  width: 22px;\n  height: 22px;\n  transform: scale(1);\n  filter: grayscale(100%);\n\n  &:hover {\n    transform: scale(1.14);\n    filter: grayscale(0%);\n  }\n']))),yt=function(e){var n=e.isReplying,t=e.replyId,r=e.messageSent,c=Object(a.useRef)(null),i=Object(a.useState)(!1),o=Object(f.a)(i,2),s=o[0],u=o[1],v=Object(a.useState)([]),b=Object(f.a)(v,2),h=b[0],j=b[1],p=Ve(H),m=Ne(),O=Object(a.useCallback)(function(){var e=Object(l.a)(d.a.mark((function e(a){var c,i;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a.preventDefault(),void 0!==p){e.next=3;break}return e.abrupt("return");case 3:if(c=a.target.innerText,a.target.innerText="",i={channelId:p.id,message:c,isReply:!1,replyId:null},!n){e.next=11;break}if(void 0!==t){e.next=9;break}return e.abrupt("return");case 9:i.isReply=!0,i.replyId=t;case 11:return e.next=13,me.emitAck("send_message",i);case 13:c=e.sent,r(),m(J([c]));case 16:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),[m,n,r,t,p]);function x(e){var n=getSelection();if(null!==n){var t=n.anchorOffset,r=e.target.innerText;if(void 0!==r){var a=r.lastIndexOf(":",t);if(-1!==a)return{selection:n,cursorPosition:t,message:r,lastIndexOfColon:a}}}}var g=Object(a.useCallback)((function(e){var n=x(e);if(void 0!==n){var t=n.cursorPosition,r=n.message,a=n.lastIndexOfColon;if(-1===(r=r.substring(a,t)).indexOf(" ")&&160!==r.charCodeAt(r.length-1)){var c=vt.search(r);if(0!==c.length)return c}}}),[]),y=Object(a.useCallback)((function(e){if(null!==c.current){if(["ArrowDown","ArrowUp"].includes(e.code))return e.preventDefault(),void c.current.move("ArrowUp"===e.code);if(e.code.includes("Enter")){if(!s)return O(e);e.preventDefault();var n=x(e);if(void 0!==n){var t=n.selection,r=n.cursorPosition,a=n.message,i=n.lastIndexOfColon;e.target.innerText="".concat(a.substring(0,i)).concat(c.current.getEmoji()).concat(a.substring(r+1)),t.setPosition(t.focusNode,1),j([]),u(!1)}}}}),[s,O]),C=Object(a.useCallback)((function(e){var n=g(e);if(void 0!==n)return u(!0),void j(n);u(!1),j([])}),[g]);return Object(Te.jsxs)(Te.Fragment,{children:[!s||Object(Te.jsx)(jt,{ref:c,foundEmojis:h}),Object(Te.jsxs)(xt,{children:[Object(Te.jsx)("button",{type:"button",className:"btn btn--off btn--hover btn__icon",children:Object(Te.jsx)(rt,{})}),Object(Te.jsx)(ct,{onKeyDown:y,onKeyUp:C,onClick:C}),Object(Te.jsx)("button",{type:"button",className:"btn btn--off btn--hover btn__icon",children:Object(Te.jsx)(it,{})}),Object(Te.jsx)("button",{type:"button",className:"btn btn__icon",children:Object(Te.jsx)(gt,{})})]})]})};var Ct=Ee.a.ol(pt||(pt=Object(Re.a)(["\n  word-break: break-all;\n"]))),It=Ee.a.div(mt||(mt=Object(Re.a)(["\n  flex-grow: 1;\n  display: flex;\n  flex-direction: column;\n"]))),kt=Ee.a.div(Ot||(Ot=Object(Re.a)(["\n  flex-grow: 1;\n  overflow-x: hidden;\n"]))),wt=function(){var e=Object(a.useRef)(null),n=Ve(rn),t=Ve(P),r=Ve(H),c=ke(),i=Object(f.a)(c,2),o=i[0],s=i[1],u=s.data,d=s.isSuccess,l=s.status,v=Ne(),b=Object(a.useState)(0),h=Object(f.a)(b,2),j=h[0],p=h[1],m=Object(a.useState)(!1),O=Object(f.a)(m,2),x=O[0],g=O[1],y=Object(a.useState)(!1),C=Object(f.a)(y,2),I=C[0],k=C[1],w=Object(a.useState)(),_=Object(f.a)(w,2),S=_[0],N=_[1];Object(a.useEffect)((function(){var n;null===(n=e.current)||void 0===n||n.scroll(0,e.current.scrollHeight)}),[n]),Object(a.useEffect)((function(){d&&"fulfilled"===l&&void 0!==r&&void 0!==u&&(0!==u.length?(v(J(u)),v(F(r.id))):g(!0))}),[l]);var V=Object(a.useCallback)((function(){var n;if(void 0!==r&&0===(null===(n=e.current)||void 0===n?void 0:n.scrollTop)){if(x)return;if(!ie.offline)return o({serverId:r.serverId,channelId:r.id,offset:j}),void p(j+30)}}),[r,o,j,x]);function L(e){N(e),k(!0)}return Object(Te.jsxs)(It,{children:[Object(Te.jsx)(kt,{ref:e,onScroll:V,children:Object(Te.jsx)(Ct,{className:"list",children:n.map((function(e){var n;return Object(Te.jsx)(nt,{serverId:e.serverId,channelId:e.channelId,messageId:e.id,username:(null===(n=t.find((function(n){return n.id===e.userId})))||void 0===n?void 0:n.username)||"",text:e.text,timestamp:e.timestamp,isReply:e.isReply,replyId:e.replyId,reply:L},"message_".concat(e.id))})).sort((function(e,n){return Date.parse(e.props.timestamp)-Date.parse(n.props.timestamp)}))})}),!I||Object(Te.jsx)("div",{children:"replying"}),Object(Te.jsx)(yt,{isReplying:I,replyId:S,messageSent:function(){N(void 0),k(!1)}})]})};var _t,St=function(e){var n=e.name;return Object(Te.jsx)("li",{children:n})};var Ht,Nt,Vt,Pt,Lt,Mt,Rt=Ee.a.div(_t||(_t=Object(Re.a)(["\n  width: var(--members-panel-width);\n  background-color: var(--color-third);\n  height: 100%;\n  flex-shrink: 0;\n"]))),Et=function(){var e=Ve(P),n=Ve(Vn);return Object(Te.jsx)(Rt,{children:Object(Te.jsx)("ol",{className:"list",children:n.map((function(n){var t;return Object(Te.jsx)(St,{name:(null===(t=e.find((function(e){return e.id===n.userId})))||void 0===t?void 0:t.firstName)||""},"member_".concat(n.id))}))})})};var Tt=Ee.a.span(Ht||(Ht=Object(Re.a)(["\n  flex-grow: 1;\n"]))),At=Ee.a.div(Nt||(Nt=Object(Re.a)(["\n  flex-grow: 1;\n  background-color: var(--color-secondary);\n  color: white;\n  display: flex;\n  flex-direction: column;\n"]))),Dt=Ee.a.div(Vt||(Vt=Object(Re.a)(["\n  width: var(--members-panel-width);\n"]))),Zt=Ee.a.div(Pt||(Pt=Object(Re.a)(["\n  display: flex;\n  flex-grow: 1;\n  max-height: calc(100% - 3em);\n"]))),zt=Ee.a.header(Lt||(Lt=Object(Re.a)(["\n  display: flex;\n  align-items: center;\n  height: 3em;\n  box-shadow: var(--small-shadow-bar);\n"]))),qt=Ee.a.div(Mt||(Mt=Object(Re.a)(["\n  flex-grow: 1;\n  display: flex;\n"]))),Ut=function(){var e=Object(a.useState)(!0),n=Object(f.a)(e,2),t=n[0],c=n[1],i=Ve(H);return Object(Te.jsxs)(At,{children:[Object(Te.jsxs)(zt,{children:[Object(Te.jsxs)(qt,{children:[void 0===i||Object(Te.jsxs)(Te.Fragment,{children:[Object(Te.jsx)(Ye,{type:r.Text,isPrivate:!1}),Object(Te.jsx)(Tt,{children:i.name})]}),Object(Te.jsx)("button",{type:"button",className:"btn ".concat(t?"btn--active":"btn--off"," btn--hover"),onClick:function(){return c(!t)},children:Object(Te.jsx)(Gn,{})})]}),Object(Te.jsx)(Dt,{children:"placeholder"})]}),Object(Te.jsxs)(Zt,{children:[Object(Te.jsx)(wt,{}),!t||Object(Te.jsx)(Et,{})]})]})};var Bt=function(){var e=Ne();return Object(Te.jsx)("div",{className:"overlay",children:Object(Te.jsxs)("div",{className:"overlay__container",children:[Object(Te.jsx)("h1",{className:"h1",children:"Add a server"}),Object(Te.jsxs)("div",{className:"overlay__body",children:[Object(Te.jsx)("button",{type:"button",className:"btn btn__overlay-select",onClick:function(){e(Q({type:"CreateServerOverlayComponent"}))},children:"Create a server"}),Object(Te.jsx)("button",{type:"button",className:"btn btn__overlay-select",onClick:function(){e(Q({type:"JoinServerOverlayComponent"}))},children:"Join a server"})]})]})})};var Ft=function(e){var n=e.groupId,t=void 0===n?null:n,c=Object(a.useRef)(null),i=Ve(N),o=Ce(),s=Object(f.a)(o,2),u=s[0],d=s[1],l=d.data,v=d.isSuccess,b=Ne();return Object(a.useEffect)((function(){var e;if(void 0!==i&&v&&void 0!==l){var n=null===(e=c.current)||void 0===e?void 0:e.value,a={id:null===l||void 0===l?void 0:l.channelId,serverId:i.id,groupId:t,type:r.Text,name:n,messages:[],order:0};b(W(a)),b(F(a.id)),b(Q(null))}}),[v]),Object(Te.jsx)("div",{className:"overlay",children:Object(Te.jsxs)("div",{className:"overlay__container",children:[Object(Te.jsx)("h1",{className:"h1",children:"Channel name"}),Object(Te.jsx)("input",{type:"text",ref:c}),Object(Te.jsx)("button",{type:"button",className:"btn btn__overlay-select",onClick:function(){var e;if(!ie.offline&&void 0!==i){var n=null===(e=c.current)||void 0===e?void 0:e.value;u({serverId:i.id,groupId:t,channelName:n})}},children:"Create"})]})})};var Qt=function(){var e=Object(a.useRef)(null),n=Ve(N),t=Ie(),r=Object(f.a)(t,2),c=r[0],i=r[1].data;return Object(a.useEffect)((function(){}),[i]),Object(Te.jsx)("div",{className:"overlay",children:Object(Te.jsxs)("div",{className:"overlay__container",children:[Object(Te.jsx)("h1",{className:"h1",children:"Group name"}),Object(Te.jsx)("input",{type:"text",ref:e}),Object(Te.jsx)("button",{type:"button",className:"btn btn__overlay-select",onClick:function(){var t;if(!ie.offline&&void 0!==n){var r=null===(t=e.current)||void 0===t?void 0:t.value;c({serverId:n.id,groupName:r})}},children:"Create"})]})})};var Gt=function(){var e=Ne(),n=Object(a.useRef)(null),t=ye(),r=Object(f.a)(t,2),c=r[0],i=r[1],o=i.data,s=i.isSuccess;return Object(a.useEffect)((function(){s&&void 0!==o&&(e(Q(null)),e(G(o.servers[0])),e(ee(o.users[0])))}),[s]),Object(Te.jsx)("div",{className:"overlay",children:Object(Te.jsxs)("div",{className:"overlay__container",children:[Object(Te.jsx)("h1",{className:"h1",children:"Create a server"}),Object(Te.jsxs)("div",{className:"overlay__body",children:[Object(Te.jsx)("input",{type:"text",ref:n}),Object(Te.jsx)("button",{type:"button",className:"btn btn__overlay-select",onClick:function(){var e;c(null===(e=n.current)||void 0===e?void 0:e.value)},children:"Create"})]})]})})};var Jt=function(e){var n=e.invitation,t=Object(a.useState)("Copy"),r=Object(f.a)(t,2),c=r[0],i=r[1],o=Ne(),s=Object(a.useCallback)(Object(l.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,navigator.clipboard.writeText(n);case 3:i("Copied"),e.next=10;break;case 6:e.prev=6,e.t0=e.catch(0),console.error(e.t0),i("Error");case 10:case"end":return e.stop()}}),e,null,[[0,6]])}))),[n]);return Object(Te.jsx)("div",{className:"overlay",children:Object(Te.jsxs)("div",{className:"overlay__container",children:[Object(Te.jsx)("button",{type:"button",onClick:function(){o(Q(null))},children:"X"}),Object(Te.jsx)("h1",{className:"h1",children:"Share the invitation with a friend"}),Object(Te.jsxs)("div",{className:"overlay__body",children:[Object(Te.jsx)("span",{className:"span",children:n}),Object(Te.jsx)("button",{type:"button",className:"btn btn__overlay-select",onClick:s,children:c})]})]})})};var Kt=function(){var e=Object(a.useRef)(null),n=ge(),t=Object(f.a)(n,2),r=t[0],c=t[1],i=c.data,o=c.isSuccess,s=Ne();return Object(a.useEffect)((function(){o&&void 0!==i&&(s(G(i.servers[0])),s(ee(i.users[0])),s(Q(null)))}),[o]),Object(Te.jsx)("div",{className:"overlay",children:Object(Te.jsxs)("div",{className:"overlay__container",children:[Object(Te.jsx)("h1",{className:"h1",children:"Join a server"}),Object(Te.jsxs)("div",{className:"overlay__body",children:[Object(Te.jsx)("input",{type:"text",ref:e}),Object(Te.jsx)("button",{type:"button",className:"btn btn__overlay-select",onClick:function(){var n;r(null===(n=e.current)||void 0===n?void 0:n.value)},children:"Join"})]})]})})},Wt=t(103),Xt=t(104),Yt=t.n(Xt),$t=t(66),er=new(function(){function e(){Object(re.a)(this,e),this.authInstance=void 0,this.isProduction=!1,this._token="",this.isProduction?this.authInstance=new $t.a(Object(w.a)({useRefreshTokens:!0},ie.auth0)):this.authInstance=new Yt.a(ie.keycloak)}return Object(Wt.a)(e,[{key:"token",get:function(){return this._token}},{key:"init",value:function(){var e=Object(l.a)(d.a.mark((function e(){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=!1,!this.isProduction){e.next=18;break}return e.next=4,Object($t.b)(Object(w.a)({useRefreshTokens:!0},ie.auth0));case 4:return this.authInstance=e.sent,e.next=7,this.authInstance.isAuthenticated();case 7:if(n=e.sent){e.next=13;break}return e.next=11,this.authInstance.loginWithRedirect({redirect_uri:window.location.origin});case 11:e.next=16;break;case 13:return e.next=15,this.authInstance.getTokenSilently();case 15:this._token=e.sent;case 16:e.next=27;break;case 18:return e.next=20,this.authInstance.init({onLoad:"check-sso",silentCheckSsoRedirectUri:window.location.origin+"/silent-check-sso.html"});case 20:if(n=e.sent){e.next=26;break}return e.next=24,this.authInstance.login();case 24:e.next=27;break;case 26:this._token=this.authInstance.token||"";case 27:return e.abrupt("return",n);case 28:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"isAuthenticated",value:function(){if(this.isProduction)return this.authInstance.isAuthenticated();var e=this.authInstance.authenticated;return void 0===e?Promise.resolve(!1):Promise.resolve(e)}},{key:"getToken",value:function(){if(this.isProduction)return this.authInstance.getTokenSilently();var e=this.authInstance.token;return void 0===e?Promise.resolve(""):Promise.resolve(e)}},{key:"getSubject",value:function(){var e=Object(l.a)(d.a.mark((function e(){var n,t;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isProduction){e.next=9;break}return e.next=3,this.authInstance.getUser();case 3:if(void 0!==(n=e.sent)){e.next=6;break}return e.abrupt("return","");case 6:if(void 0!==n.sub){e.next=8;break}return e.abrupt("return","");case 8:return e.abrupt("return",n.sub);case 9:if(void 0!==(t=this.authInstance.subject)){e.next=12;break}return e.abrupt("return",Promise.resolve(""));case 12:return e.abrupt("return",Promise.resolve(t));case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}()),nr=[];function tr(e){var n=e.type,t=e.payload;switch(n){case"AddServerOverlayComponent":return Object(Te.jsx)(Bt,{});case"CreateChannelOverlayComponent":return Object(Te.jsx)(Ft,{groupId:t.groupId});case"CreateGroupOverlayComponent":return Object(Te.jsx)(Qt,{});case"CreateServerOverlayComponent":return Object(Te.jsx)(Gt,{});case"InvitationOverlayComponent":return Object(Te.jsx)(Jt,{invitation:t.invitation});case"JoinServerOverlayComponent":return Object(Te.jsx)(Kt,{})}}var rr=function(){var e=Ve(y),n=Ve(S),t=Ve(N),r=Ve(V),c=Ve(L),i=Ve(an),o=xe(),s=Object(f.a)(o,2),u=s[0],v=s[1],b=v.data,h=v.isSuccess,j=v.status,p=Ne();return Object(a.useEffect)((function(){null!==c&&Object(l.a)(d.a.mark((function e(){var n,t,r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,er.getSubject();case 2:return n=e.sent,t=i.filter((function(e){return e.userId!==n&&!nr.find((function(n){return e.socketId===n.socketId}))})),fe||0!==ue.getAudioTracks().length&&(fe=!0,de.createMediaStreamSource(ue).connect(de.destination)),r=[],t.forEach((function(e){r.push(new Promise(function(){var n=Object(l.a)(d.a.mark((function n(t){var r,a,c,i,o,s;return d.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,me.emitAck("create_transport",{type:"recv"});case 2:return r=n.sent,a=r.transportParameters,(c=ve.createRecvTransport(a)).on("connect",(function(e,n){var t=e.dtlsParameters;me.emit("connect_transport",{type:"recv",dtlsParameters:t,id:c.id},n)})),n.next=8,me.emitAck("create_consumer",{transportId:c.id,socketId:e.socketId,rtpCapabilities:ve.rtpCapabilities});case 8:return i=n.sent,o=i.consumerParameters,n.next=12,c.consume(o);case 12:s=n.sent,ue.addTrack(s.track),me.emit("resume_consumer",{id:s.id}),nr.push({socketId:e.socketId,consumer:s}),t();case 17:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()))})),e.next=9,Promise.all(r);case 9:case"end":return e.stop()}}),e)})))()}),[i,c,t]),Object(a.useEffect)((function(){ie.offline||Object(l.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,er.isAuthenticated();case 2:if(!e.sent){e.next=5;break}return e.abrupt("return");case 5:return e.next=7,er.init();case 7:e.sent&&(me.auth.token=er.getToken(),me.connected||me.connect());case 9:case"end":return e.stop()}}),e)})))()}),[]),Object(a.useEffect)((function(){ie.offline?p(Z({servers:Me,users:Le})):e&&(n||u())}),[n,e]),Object(a.useEffect)((function(){h&&void 0!==b&&p(Z(b))}),[j]),Object(Te.jsxs)(Te.Fragment,{children:[null===r||tr(r),Object(Te.jsx)(Be,{}),Object(Te.jsx)(Dn,{}),Object(Te.jsx)(Ut,{})]})};o.a.render(Object(Te.jsx)(c.a.StrictMode,{children:Object(Te.jsx)(h.Provider,{store:He,children:Object(Te.jsx)(rr,{})})}),document.getElementById("root")),s()}},[[191,1,2]]]);
//# sourceMappingURL=main.8464693c.chunk.js.map